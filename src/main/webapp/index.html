<!DOCTYPE html>

<html>

  <head>
  
  	<meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Futbol 7</title>
  
	<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" />
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.9.1/bootstrap-table.min.css" />
	<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" />
	
	
	<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.9.1/bootstrap-table.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-table/1.9.1/locale/bootstrap-table-es-ES.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-timeago/1.4.3/jquery.timeago.min.js"></script>
	<script src="https://code.highcharts.com/highcharts.js"></script>
<!-- 	<script src="https://code.highcharts.com/highcharts-more.js"></script> -->
	<script src="resources/json/full.js"></script>
	<script src="resources/json/permanents.js"></script>
	<script src="resources/json/substitutes.js"></script>
	<script src="resources/json/vs.js"></script>
	<script src="resources/json/pair.js"></script>
	<script src="resources/json/pointsSeries.js"></script>
	<script src="resources/json/matches.js"></script>
	
	<link rel="shortcut icon" href="resources/images/futbol.ico" />
	
	<style>
	.label-lastmatch{
	    display: inline-block;
    	width: 20px;
    }
	</style>

  </head>

  <body>
  
  <script>

	  function decimal(value, row) {
	
	      return parseFloat(Math.round(value * 100) / 100).toFixed(2);
	  }
	  

	    function lastMatchesFormat(value) {
	    	var ret = '';
	    	var len = value.length;
	    	var numMatches = 5;
	    	for (var i = len-numMatches; i < len; i++) {
		        if(value[i]=='w') ret = ret + '<span class="label label-success label-lastmatch">V</span>';
		        if(value[i]=='d') ret = ret + '<span class="label label-warning label-lastmatch">E</span>';
		        if(value[i]=='l') ret = ret + '<span class="label label-danger label-lastmatch">D</span>';
		        if(value[i]=='-') ret = ret + '<span class="label label-default label-lastmatch">-</span>';
	    	}
	        return ret;
	    }
  
	  $(function () {
		  
		  $.timeago.settings.strings = {
				   prefixAgo: "hace",
				   prefixFromNow: "dentro de",
				   suffixAgo: "",
				   suffixFromNow: "",
				   seconds: "menos de un minuto",
				   minute: "un minuto",
				   minutes: "unos %d minutos",
				   hour: "una hora",
				   hours: "%d horas",
				   day: "un día",
				   days: "%d días",
				   month: "un mes",
				   months: "%d meses",
				   year: "un año",
				   years: "%d años"
				};
		  
		  
		    $('#table-full').bootstrapTable({
		        data: full,
		        locale:'es-ES'
		    });
		  
		    $('#table-permanents').bootstrapTable({
		        data: permanents,
		        locale:'es-ES'
		    });
		  
		    $('#table-substitutes').bootstrapTable({
		        data: substitutes,
		        locale:'es-ES'
		    });
		  
		    $('#table-vs').bootstrapTable({
		        data: vs,
		        locale:'es-ES'
		    });
		  
		    $('#table-pair').bootstrapTable({
		        data: pair,
		        locale:'es-ES'
		    });
		  
		    var numMatches = matches.length;
		    var currentMatch = numMatches-1;
		    var lastMatch = matches[numMatches-1].data;
		    
		    $('#table-results').bootstrapTable({
		        data: lastMatch,
		        locale:'es-ES'
		    });
		    
		    $('#table-results thead tr:first th div.th-inner').text('Jornada '+numMatches+' ('+$.timeago(matches[numMatches-1].day)+')');
		    $('#table-results thead tr:last th:first div.th-inner span').text(matches[numMatches-1].scoreBlues);
		    $('#table-results thead tr:last th:last div.th-inner span').text(matches[numMatches-1].scoreWhites);
		    
		    $('#next-match').addClass('disabled');
		    
		    var updateResult = function(currentMatch){
			    var newMatch = matches[currentMatch].data;
			    var remarks = (matches[currentMatch].remarks.indexOf('RD') > -1) ?' (Número de goles desconocido, por defecto 2-0 o 0-0)':'';
			    
			    $('#table-results').bootstrapTable('load',newMatch);
			    
			    $('#table-results thead tr:first th div.th-inner').text('Jornada '+(currentMatch+1)+' ('+$.timeago(matches[currentMatch].day)+')'+remarks);
			    $('#table-results thead tr:last th:first div.th-inner span').text(matches[currentMatch].scoreBlues);
			    $('#table-results thead tr:last th:last div.th-inner span').text(matches[currentMatch].scoreWhites);
			};
		    
		    $('#next-match').click(function(){
		    	currentMatch = currentMatch + 1;
			    $('#previous-match').removeClass('disabled');
		    	if(currentMatch==(numMatches-1)){
				    $('#next-match').addClass('disabled');
		    	}
		    	updateResult(currentMatch);
		    });
		    
		    $('#previous-match').click(function(){
		    	currentMatch = currentMatch - 1;
			    $('#next-match').removeClass('disabled');
		    	if(currentMatch==0){
				    $('#previous-match').addClass('disabled');
		    	}
		    	updateResult(currentMatch);
		    });

		    var hash = window.location.hash.substr(1);
		    if(hash==='admin'){
		    	$('#table-full, #table-permanents, #table-substitutes').bootstrapTable('showColumn', 'realPoints');
		    	$('#table-full, #table-permanents, #table-substitutes').bootstrapTable('showColumn', 'wins');
		    	$('#table-full, #table-permanents, #table-substitutes').bootstrapTable('showColumn', 'draws');
		    	$('#table-full, #table-permanents, #table-substitutes').bootstrapTable('showColumn', 'loses');
		    	$('#table-full, #table-permanents, #table-substitutes').bootstrapTable('showColumn', 'matches');
		    	$('#table-full, #table-permanents, #table-substitutes').bootstrapTable('showColumn', 'goalsFor');
		    	$('#table-full, #table-permanents, #table-substitutes').bootstrapTable('showColumn', 'goalsAgainst');
		    	$('#table-full, #table-permanents, #table-substitutes').bootstrapTable('showColumn', 'pointsAVG');
		    	$('#table-full, #table-permanents, #table-substitutes').bootstrapTable('showColumn', 'goalsForAVG');
		    	$('#table-full, #table-permanents, #table-substitutes').bootstrapTable('showColumn', 'goalsAgainstAVG');

		    	$('#table-full').closest('.row').show();
		    	$('#table-vs').closest('.row').show();
		    	
		    	$('#container').parent().parent().parent().parent().show();
				  $('#container').highcharts({
				        chart: {
				            type: 'line'
				        },
				        title: {
				            text: 'Acumulación de Puntos',
				            style: { "display": "none"}
				        },
				        xAxis: {
				            type: 'datetime',
				            dateTimeLabelFormats: {
				                month: '%e. %b',
				                year: '%b'
				            },
				            title: {
				                text: 'Dia'
				            }
				        },
				        yAxis: {
				            title: {
				                text: 'Puntos'
				            },
				            min: 0
				        },
//		 		        tooltip: {
//		 		            headerFormat: '<b>{series.name}</b><br>',
//		 		            pointFormat: '{point.x:%e. %b}: {point.y:.2f} m'
//		 		        },

//		 		        plotOptions: {
//		 		            line: {
//		 		                step: false,
		// // 		                pointStart: 0
//		 		                connectNulls: true
//		 		            }
//		 		        },

				        series: pointsSeries
				    });
		    }
		    
		});
  </script>
  
	<nav class="navbar navbar-inverse" id="top-navbar">
	  <div class="container-fluid">
	    <div class="navbar-header" style="float: none;">
<!-- 	      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false"> -->
<!-- 	        <span class="sr-only">Toggle navigation</span> -->
<!-- 	        <span class="icon-bar"></span> -->
<!-- 	        <span class="icon-bar"></span> -->
<!-- 	        <span class="icon-bar"></span> -->
<!-- 	      </button> -->
	      <img alt="Pelota de futbol" src="resources/images/futbol.png" style="position:absolute"/>
	      <a class="navbar-brand" href="#" style="margin-left: 65px">Futbol 7</a>
<!-- 	      <form class="navbar-form navbar-right" role="search"> -->
<!-- 	        <div class="form-group"> -->
<!-- 	        </div> -->
<!-- 	      </form> -->
          <button type="button" class="btn btn-default pull-right" data-toggle="modal" data-target="#legend" style="margin-top: 8px;margin-right: 10px;">
			  <span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"></span>
			</button>
	    </div>
<!--          <button type="button" class="btn btn-default navbar-right" data-toggle="modal" data-target="#legend"> -->
<!-- 		  <span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"></span> -->
<!-- 		</button> -->
	    
<!-- 	    <div class="collapse navbar-collapse" id="navbar-collapse"> -->
<!-- 	      <ul id="menu-list" class="nav navbar-nav"> -->
	      
<!-- 	      </ul> -->
<!-- 	    </div> -->
<!-- 	    <div class="" id=""> -->
<!-- 	    </div> -->
	  </div>
	</nav>
	
	<!-- Legend -->
	<div class="modal fade" id="legend" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
	  <div class="modal-dialog" role="document">
	    <div class="modal-content">
	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
	        <h4 class="modal-title" id="myModalLabel">Leyenda</h4>
	      </div>
	      <div class="modal-body">
	        UP - Últimos partidos<br/>
	        Pts - Puntos (3 puntos victoria, 2 empate, 1 derrota y  0 no jugados)<br/>
	        Pts* - Puntos (3 puntos victoria, 1 empate, 0 derrota y no jugados)<br/>
	        G - Partidos Ganados<br/>
	        E - Partidos Empatados<br/>
	        P - Partidos Perdidos<br/>
	        J - Partidos Jugados<br/>
	        GF - Goles a Favor<br/>
	        GC - Goles en Contra<br/>
	        <span style="text-decoration:overline">Pts</span> - Media de Puntos (con al menos 25% partidos jugados)<br/>
	        <span style="text-decoration:overline">GF</span> - Media de Goles a Favor (con al menos 25% partidos jugados)<br/>
	        <span style="text-decoration:overline">GC</span> - Media de Goles en Contra (con al menos 25% partidos jugados)
	      </div>
<!-- 	      <div class="modal-footer"> -->
<!-- 	        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button> -->
<!-- 	        <button type="button" class="btn btn-primary">Save changes</button> -->
<!-- 	      </div> -->
	    </div>
	  </div>
	</div>
	
	<div id="home-page" class="container-fluid" style="">
		<div class="row" style="display:none">
			<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
			
				<div id="" class="panel panel-default">
				  <div class="panel-heading">
				    <h3 class="panel-title">Total</h3>
				  </div>
				  <div class="panel-body">
						<table id="table-full" data-sort-name=points data-sort-order="desc"  data-striped="true">
							<thead>
								<tr>
									<th data-field="name" data-sortable="true">Nombre</th>
									<th data-field="lastMatches" data-formatter="lastMatchesFormat" data-sortable="false" data-align="center">UP</th>
									<th data-field="points" data-sortable="true" data-align="right">Pts</th>
									<th data-field="realPoints" data-sortable="true" data-align="right" data-visible="false">Pts*</th>
									<th data-field="wins" data-sortable="true" data-align="right" data-visible="false">G</th>
									<th data-field="draws" data-sortable="true" data-align="right" data-visible="false">E</th>
									<th data-field="loses" data-sortable="true" data-align="right" data-visible="false">P</th>
									<th data-field="matches" data-sortable="true" data-align="right" data-visible="false">J</th>
									<th data-field="goalsFor" data-sortable="true" data-align="right" data-visible="false">GF</th>
									<th data-field="goalsAgainst" data-sortable="true" data-align="right" data-visible="false">GC</th>
									<th data-field="pointsAVG" data-sortable="true" data-align="right" data-formatter="decimal" data-visible="false"><span style="text-decoration:overline">Pts</span></th>
									<th data-field="goalsForAVG" data-sortable="true" data-align="right" data-formatter="decimal" data-visible="false"><span style="text-decoration:overline">GF</span></th>
									<th data-field="goalsAgainstAVG" data-sortable="true" data-align="right" data-formatter="decimal" data-visible="false"><span style="text-decoration:overline">GC</span></th>
								</tr>
							</thead>
						</table>
					</div>
				</div>
			
			</div>
		</div>
			
		<div class="row">
			<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
			
				<div id="" class="panel panel-default">
				  <div class="panel-heading">
				    <h3 class="panel-title">Titulares</h3>
				  </div>
				  <div class="panel-body">
						<table id="table-permanents" data-sort-name="points" data-sort-order="desc" data-striped="true">
							<thead>
								<tr>
									<th data-field="name" data-sortable="true">Nombre</th>
									<th data-field="lastMatches" data-formatter="lastMatchesFormat" data-sortable="false" data-align="center">UP</th>
									<th data-field="points" data-sortable="true" data-align="right">Pts</th>
									<th data-field="realPoints" data-sortable="true" data-align="right" data-visible="false">Pts*</th>
									<th data-field="wins" data-sortable="true" data-align="right" data-visible="false">G</th>
									<th data-field="draws" data-sortable="true" data-align="right" data-visible="false">E</th>
									<th data-field="loses" data-sortable="true" data-align="right" data-visible="false">P</th>
									<th data-field="matches" data-sortable="true" data-align="right" data-visible="false">J</th>
									<th data-field="goalsFor" data-sortable="true" data-align="right" data-visible="false">GF</th>
									<th data-field="goalsAgainst" data-sortable="true" data-align="right" data-visible="false">GC</th>
									<th data-field="pointsAVG" data-sortable="true" data-align="right" data-formatter="decimal" data-visible="false"><span style="text-decoration:overline">Pts</span></th>
									<th data-field="goalsForAVG" data-sortable="true" data-align="right" data-formatter="decimal" data-visible="false"><span style="text-decoration:overline">GF</span></th>
									<th data-field="goalsAgainstAVG" data-sortable="true" data-align="right" data-formatter="decimal" data-visible="false"><span style="text-decoration:overline">GC</span></th>
								</tr>
							</thead>
						</table>
					</div>
				</div>
			
			</div>
			<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
			
				<div id="" class="panel panel-default">
				  <div class="panel-heading">
				    <h3 class="panel-title">Suplentes</h3>
				  </div>
				  <div class="panel-body">
						<table id="table-substitutes" data-sort-name="points" data-sort-order="desc" data-striped="true">
							<thead>
								<tr>
									<th data-field="name" data-sortable="true">Nombre</th>
									<th data-field="lastMatches" data-formatter="lastMatchesFormat" data-sortable="false" data-align="center">UP</th>
									<th data-field="points" data-sortable="true" data-align="right">Pts</th>
									<th data-field="realPoints" data-sortable="true" data-align="right" data-visible="false">Pts*</th>
									<th data-field="wins" data-sortable="true" data-align="right" data-visible="false">G</th>
									<th data-field="draws" data-sortable="true" data-align="right" data-visible="false">E</th>
									<th data-field="loses" data-sortable="true" data-align="right" data-visible="false">P</th>
									<th data-field="matches" data-sortable="true" data-align="right" data-visible="false">J</th>
									<th data-field="goalsFor" data-sortable="true" data-align="right" data-visible="false">GF</th>
									<th data-field="goalsAgainst" data-sortable="true" data-align="right" data-visible="false">GC</th>
									<th data-field="pointsAVG" data-sortable="true" data-align="right" data-formatter="decimal" data-visible="false"><span style="text-decoration:overline">Pts</span></th>
									<th data-field="goalsForAVG" data-sortable="true" data-align="right" data-formatter="decimal" data-visible="false"><span style="text-decoration:overline">GF</span></th>
									<th data-field="goalsAgainstAVG" data-sortable="true" data-align="right" data-formatter="decimal" data-visible="false"><span style="text-decoration:overline">GC</span></th>
								</tr>
							</thead>
						</table>
					</div>
				</div>
			
			</div>
		</div>
		
		<div class="row" style="display:none">
			<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
			
				<div id="" class="panel panel-default">
				  <div class="panel-heading">
				    <h3 class="panel-title">Veces como adversarios</h3>
				  </div>
				  <div class="panel-body">
						<table id="table-vs" data-sort-name="vs" data-sort-order="desc"
               data-pagination="true">
							<thead>
								<tr>
									<th data-field="player1" data-sortable="true">Nombre</th>
									<th data-field="player2" data-sortable="true">Nombre</th>
									<th data-field="vs" data-sortable="true" data-align="right">J</th>
								</tr>
							</thead>
						</table>
					</div>
				</div>
			
			</div>
			<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
			
				<div id="" class="panel panel-default">
				  <div class="panel-heading">
				    <h3 class="panel-title">Veces en el mismo equipo</h3>
				  </div>
				  <div class="panel-body">
						<table id="table-pair" data-sort-name="pair" data-sort-order="desc"
               data-pagination="true">
							<thead>
								<tr>
									<th data-field="player1" data-sortable="true">Nombre</th>
									<th data-field="player2" data-sortable="true">Nombre</th>
									<th data-field="pair" data-sortable="true" data-align="right">J</th>
								</tr>
							</thead>
						</table>
					</div>
				</div>
			
			</div>
			<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
			
				<div id="" class="panel panel-default">
				  <div class="panel-heading">
				    <h3 class="panel-title">Jornadas</h3>
				  </div>
				  <div class="panel-body">
						<table id="table-results">
							<thead>
								<tr>
									<th colspan="2">Jornada X - Dia Y</th>
								</tr>
								<tr>
									<th data-field="blue" >Equipo Azul <span class="pull-right"></span></th>
									<th data-field="white" >Equipo Blanco <span class="pull-right"></span></th>
								</tr>
							</thead>
							<tfoot>
								<tr>
									<th><button id="previous-match" class="btn pull-left">Anterior</button></th>
									<th><button id="next-match" class="btn pull-right">Siguiente</button></th>
								</tr>
							</tfoot>
						</table>
					</div>
				</div>
			
			</div>
		</div>
		
		
		<div class="row" style="display:none">
			<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
			
				<div id="" class="panel panel-default">
				  <div class="panel-heading">
				    <h3 class="panel-title">Evolución de Puntos</h3>
				  </div>
				  <div class="panel-body">
				  		<div id="container" style="min-width: 310px; height: 600px; margin: 0 auto"></div>
					</div>
				</div>
			
			</div>
		</div>
		
	</div>
		
  </body>
</html>
